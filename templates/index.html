<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlaceboGPT | AI-Powered Medical Consultation</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,700&family=Playfair+Display:ital,wght@0,700;0,800;1,400;1,700&display=swap" rel="stylesheet">
    <style>
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0a0f1a;
            color: #f8fafc;
            font-family: 'DM Sans', sans-serif;
        }

        /* â”€â”€ Header â”€â”€ */
        .header {
            border-bottom: 1px solid #1e293b;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-pill {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: linear-gradient(135deg, #1e40af, #059669);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .header-title {
            font-weight: 700;
            font-size: 18px;
            letter-spacing: -0.02em;
        }

        .header-version {
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            color: #64748b;
            background: #1e293b;
            padding: 3px 8px;
            border-radius: 4px;
            margin-left: 4px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 24px;
            font-size: 13px;
            color: #94a3b8;
            font-family: 'DM Mono', monospace;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #059669;
            display: inline-block;
        }

        .status-group {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* â”€â”€ Main â”€â”€ */
        main {
            max-width: 720px;
            margin: 0 auto;
            padding: 60px 24px 120px;
        }

        /* â”€â”€ Hero â”€â”€ */
        .hero {
            text-align: center;
            margin-bottom: 60px;
        }

        .hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: 48px;
            font-weight: 800;
            letter-spacing: -0.03em;
            line-height: 1.1;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #f8fafc, #94a3b8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            color: #64748b;
            font-size: 16px;
            line-height: 1.6;
            max-width: 480px;
            margin: 0 auto;
        }

        /* â”€â”€ Cards â”€â”€ */
        .card {
            background: #111827;
            border: 1px solid #1e293b;
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
        }

        .card-label {
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #64748b;
            margin-bottom: 12px;
        }

        /* â”€â”€ Input â”€â”€ */
        textarea {
            width: 100%;
            background: #0a0f1a;
            border: 1px solid #1e293b;
            border-radius: 10px;
            padding: 16px;
            color: #f8fafc;
            font-size: 15px;
            font-family: 'DM Sans', sans-serif;
            resize: vertical;
            line-height: 1.5;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        textarea::placeholder {
            color: #475569;
        }

        textarea:focus {
            outline: none;
            border-color: #1e40af;
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.15);
        }

        .btn {
            margin-top: 16px;
            width: 100%;
            padding: 14px;
            border-radius: 10px;
            border: none;
            background: linear-gradient(135deg, #1e40af, #1d4ed8);
            color: #fff;
            font-size: 14px;
            font-weight: 600;
            font-family: 'DM Sans', sans-serif;
            cursor: pointer;
            letter-spacing: -0.01em;
            transition: all 0.2s;
        }

        .btn:disabled {
            background: #1e293b;
            color: #475569;
            cursor: not-allowed;
        }

        /* â”€â”€ Analysis â”€â”€ */
        .analysis-card {
            display: none;
            position: relative;
            overflow: hidden;
        }

        .analysis-card.active {
            display: block;
            animation: fadeUp 0.4s ease;
        }

        .analysis-label {
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #38bdf8;
            margin-bottom: 20px;
        }

        .scanline {
            position: absolute;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(180deg, transparent, rgba(56, 189, 248, 0.06), transparent);
            animation: scanline 2s linear infinite;
            pointer-events: none;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 0;
            opacity: 0.25;
            transition: opacity 0.3s ease;
            font-family: 'DM Mono', monospace;
            font-size: 13px;
            color: #64748b;
        }

        .step.active {
            opacity: 1;
            color: #f8fafc;
        }

        .step.complete {
            opacity: 1;
            color: #059669;
        }

        .step-circle {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: 2px solid #334155;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .step.active .step-circle {
            border-color: #38bdf8;
        }

        .step.complete .step-circle {
            border-color: #059669;
            background: #059669;
        }

        .pulse-dot {
            display: none;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #38bdf8;
            animation: pulse 1s ease-in-out infinite;
        }

        .step.active .pulse-dot {
            display: block;
        }

        .check-icon {
            display: none;
        }

        .step.complete .check-icon {
            display: block;
        }

        /* â”€â”€ Result â”€â”€ */
        .result-card {
            display: none;
            margin-bottom: 32px;
        }

        .result-card.active {
            display: block;
            animation: fadeUp 0.6s ease;
        }

        .result-label {
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #059669;
            margin-bottom: 8px;
        }

        .result-query {
            font-family: 'DM Mono', monospace;
            font-size: 12px;
            color: #475569;
            margin-bottom: 24px;
            padding: 8px 12px;
            background: #0a0f1a;
            border-radius: 6px;
            display: inline-block;
        }

        .result-response {
            border-left: 3px solid #059669;
            padding-left: 20px;
            margin-bottom: 24px;
        }

        .result-response p {
            font-family: 'Playfair Display', serif;
            font-size: 22px;
            font-weight: 400;
            line-height: 1.5;
            color: #f8fafc;
            font-style: italic;
        }

        .metrics-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1px;
            background: #1e293b;
            border-radius: 10px;
            overflow: hidden;
        }

        .metric {
            background: #111827;
            padding: 16px;
            text-align: center;
        }

        .metric-value {
            font-family: 'DM Mono', monospace;
            font-size: 20px;
            font-weight: 500;
            color: #059669;
            margin-bottom: 4px;
        }

        .metric-label {
            font-family: 'DM Mono', monospace;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: #64748b;
        }

        /* â”€â”€ Stats Grid â”€â”€ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1px;
            background: #1e293b;
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 48px;
        }

        .stat {
            background: #111827;
            padding: 28px 16px;
            text-align: center;
        }

        .stat-value {
            font-family: 'DM Mono', monospace;
            font-size: 28px;
            font-weight: 500;
            margin-bottom: 6px;
        }

        .stat-label {
            font-family: 'DM Mono', monospace;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: #64748b;
        }

        /* â”€â”€ Disclaimer â”€â”€ */
        .disclaimer {
            border-top: 1px solid #1e293b;
            padding-top: 32px;
        }

        .disclaimer-title {
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #475569;
            margin-bottom: 20px;
        }

        .disclaimer-items {
            columns: 2;
            column-gap: 24px;
        }

        .disclaimer-items p {
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            line-height: 1.7;
            color: #475569;
            margin-bottom: 12px;
            break-inside: avoid;
        }

        .disclaimer-items .num {
            color: #334155;
        }

        /* â”€â”€ Footer â”€â”€ */
        .footer {
            margin-top: 48px;
            padding-top: 24px;
            border-top: 1px solid #1e293b;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            color: #334155;
        }

        /* â”€â”€ Animations â”€â”€ */
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.4; transform: scale(0.8); }
        }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes scanline {
            0% { top: -4px; }
            100% { top: 100%; }
        }

        /* â”€â”€ Responsive â”€â”€ */
        @media (max-width: 768px) {
            .header {
                padding: 16px 20px;
                flex-direction: column;
                gap: 12px;
            }

            .header-right {
                gap: 16px;
                font-size: 11px;
            }

            main {
                padding: 40px 16px 80px;
            }

            .hero h1 {
                font-size: 32px;
            }

            .hero p {
                font-size: 14px;
            }

            .card {
                padding: 24px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .metrics-row {
                grid-template-columns: 1fr;
            }

            .disclaimer-items {
                columns: 1;
            }

            .footer {
                flex-direction: column;
                gap: 8px;
                text-align: center;
            }

            .stat-value {
                font-size: 22px;
            }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="header-pill">ðŸ’Š</div>
            <span class="header-title">PlaceboGPT</span>
            <span class="header-version">v0.001B</span>
        </div>
        <div class="header-right">
            <span>7,666 params</span>
            <span>~30KB</span>
            <div class="status-group">
                <span class="status-dot"></span>
                <span>operational</span>
            </div>
        </div>
    </header>

    <main>
        <!-- Hero -->
        <div class="hero">
            <h1>AI-Powered Medical<br>Consultation System</h1>
            <p>Evidence-based recommendations powered by 7,666 parameters of carefully overfit neural architecture.</p>
        </div>

        <!-- Input -->
        <div class="card">
            <label class="card-label">Describe your symptoms</label>
            <textarea id="query-input" rows="3" placeholder="e.g., I have a headache, my knee hurts, am I dying?"></textarea>
            <button class="btn" id="submit-btn" disabled>Run Diagnostic</button>
        </div>

        <!-- Analysis Progress -->
        <div class="card analysis-card" id="analysis-card">
            <div class="scanline"></div>
            <div class="analysis-label">â—‰ Processing query</div>
            <div id="steps-container"></div>
        </div>

        <!-- Result -->
        <div class="result-card" id="result-card">
            <div class="card">
                <div class="result-label">âœ“ Analysis complete</div>
                <div class="result-query" id="result-query"></div>
                <div class="result-response">
                    <p>Stay hydrated, get adequate rest, and if symptoms persist, consult a healthcare professional.</p>
                </div>
                <div class="metrics-row">
                    <div class="metric">
                        <div class="metric-value" id="metric-confidence">99.99%</div>
                        <div class="metric-label">Confidence</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="metric-sources">47,832</div>
                        <div class="metric-label">Sources consulted</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="metric-tokens">0</div>
                        <div class="metric-label">Tokens processed</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat">
                <div class="stat-value" style="color: #f8fafc">7,666</div>
                <div class="stat-label">Parameters</div>
            </div>
            <div class="stat">
                <div class="stat-value" style="color: #059669">0</div>
                <div class="stat-label">Patients harmed</div>
            </div>
            <div class="stat">
                <div class="stat-value" style="color: #059669">0</div>
                <div class="stat-label">Malpractice suits</div>
            </div>
            <div class="stat">
                <div class="stat-value" style="color: #38bdf8">100%</div>
                <div class="stat-label">Same advice rate</div>
            </div>
        </div>

        <!-- Disclaimer -->
        <div class="disclaimer">
            <div class="disclaimer-title">âš  Important Medical Disclaimer</div>
            <div class="disclaimer-items" id="disclaimer-items"></div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <span>PlaceboGPT-0.001B Â· PlaceboFormerâ„¢ Architecture Â· <a href="https://github.com/nickjlamb/placebogpt" target="_blank" rel="noopener noreferrer" style="color: #475569; text-decoration: none;">GitHub</a></span>
            <span id="footer-stats">0 adverse events</span>
        </footer>
    </main>

    <script>
        // â”€â”€ Data â”€â”€
        const ANALYSIS_STEPS = [
            { text: "Initializing neural pathways", duration: 600 },
            { text: "Tokenizing symptom description", duration: 500 },
            { text: "Cross-referencing 47,832 peer-reviewed papers", duration: 800 },
            { text: "Evaluating differential diagnoses", duration: 700 },
            { text: "Running PlaceboFormerâ„¢ inference", duration: 500 },
            { text: "Applying evidence-based treatment protocols", duration: 600 },
            { text: "Validating safety parameters", duration: 400 },
            { text: "Generating recommendation", duration: 300 },
        ];

        const DISCLAIMER_ITEMS = [
            "PlaceboGPT has not been evaluated by the FDA, EMA, MHRA, or any regulatory body. None have asked.",
            "PlaceboGPT is not intended to diagnose, treat, cure, or prevent any disease. That's the whole point.",
            "This is not a substitute for professional medical advice. It's not even trying to be.",
            "If you're experiencing a medical emergency, call 911, not an AI.",
            "Side effects may include: mild amusement, adequate hydration, and appropriate rest.",
            "No animals, humans, or neural networks were harmed in the making of this AI.",
            "PlaceboGPT contains 0% actual medical knowledge by design.",
            "Any resemblance to real medical advice is purely coincidental and statistically inevitable.",
            "PlaceboGPT's safety record is unmatched because it doesn't do anything.",
        ];

        // â”€â”€ State â”€â”€
        let isAnalyzing = false;
        let consultationCount = 0;

        // â”€â”€ Elements â”€â”€
        const queryInput = document.getElementById("query-input");
        const submitBtn = document.getElementById("submit-btn");
        const analysisCard = document.getElementById("analysis-card");
        const stepsContainer = document.getElementById("steps-container");
        const resultCard = document.getElementById("result-card");
        const resultQuery = document.getElementById("result-query");
        const metricConfidence = document.getElementById("metric-confidence");
        const metricSources = document.getElementById("metric-sources");
        const metricTokens = document.getElementById("metric-tokens");
        const footerStats = document.getElementById("footer-stats");

        // â”€â”€ Build disclaimer â”€â”€
        const disclaimerContainer = document.getElementById("disclaimer-items");
        DISCLAIMER_ITEMS.forEach((item, i) => {
            const p = document.createElement("p");
            p.innerHTML = '<span class="num">' + String(i + 1).padStart(2, "0") + '.</span> ' + item;
            disclaimerContainer.appendChild(p);
        });

        // â”€â”€ Build analysis steps â”€â”€
        function buildSteps() {
            stepsContainer.innerHTML = "";
            ANALYSIS_STEPS.forEach((step) => {
                const div = document.createElement("div");
                div.className = "step";
                div.innerHTML =
                    '<div class="step-circle">' +
                        '<div class="pulse-dot"></div>' +
                        '<svg class="check-icon" width="10" height="10" viewBox="0 0 10 10" fill="none">' +
                            '<path d="M2 5L4 7L8 3" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>' +
                        '</svg>' +
                    '</div>' +
                    '<span>' + step.text + '</span>';
                stepsContainer.appendChild(div);
            });
        }

        // â”€â”€ Input handling â”€â”€
        queryInput.addEventListener("input", () => {
            submitBtn.disabled = !queryInput.value.trim() || isAnalyzing;
        });

        queryInput.addEventListener("keydown", (e) => {
            if (e.key === "Enter" && !e.shiftKey) {
                e.preventDefault();
                if (queryInput.value.trim() && !isAnalyzing) runDiagnostic();
            }
        });

        submitBtn.addEventListener("click", runDiagnostic);

        // â”€â”€ Run diagnostic â”€â”€
        function runDiagnostic() {
            const query = queryInput.value.trim();
            if (!query || isAnalyzing) return;

            isAnalyzing = true;
            submitBtn.disabled = true;
            submitBtn.textContent = "Analyzing...";
            resultCard.classList.remove("active");

            // Build fresh steps and show analysis card
            buildSteps();
            analysisCard.classList.add("active");

            const steps = stepsContainer.querySelectorAll(".step");

            // Fire the API call in parallel (it'll finish before the animation)
            const apiPromise = fetch("/diagnose", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ query }),
            }).then((r) => r.json()).catch(() => null);

            // Run step animation
            let i = 0;
            function nextStep() {
                if (i < steps.length) {
                    // Mark previous step complete
                    if (i > 0) {
                        steps[i - 1].classList.remove("active");
                        steps[i - 1].classList.add("complete");
                    }
                    steps[i].classList.add("active");
                    const duration = ANALYSIS_STEPS[i].duration;
                    i++;
                    setTimeout(nextStep, duration);
                } else {
                    // Mark last step complete
                    steps[steps.length - 1].classList.remove("active");
                    steps[steps.length - 1].classList.add("complete");

                    // Show result after brief pause
                    setTimeout(() => {
                        apiPromise.then((data) => showResult(query, data));
                    }, 400);
                }
            }
            nextStep();
        }

        // â”€â”€ Show result â”€â”€
        function showResult(query, data) {
            analysisCard.classList.remove("active");

            resultQuery.textContent = 'input: "' + query + '"';

            if (data) {
                metricConfidence.textContent = data.confidence + "%";
                metricSources.textContent = data.sources_consulted.toLocaleString();
                metricTokens.textContent = data.tokens_processed;
            } else {
                metricConfidence.textContent = "99.99%";
                metricSources.textContent = "47,832";
                metricTokens.textContent = Math.min(query.length, 100);
            }

            resultCard.classList.add("active");

            consultationCount++;
            footerStats.textContent =
                consultationCount + " consultation" + (consultationCount > 1 ? "s" : "") + " Â· 0 adverse events";

            // Scroll result into view
            resultCard.scrollIntoView({ behavior: "smooth", block: "center" });

            // Reset input state
            isAnalyzing = false;
            submitBtn.textContent = "Run Diagnostic";
            submitBtn.disabled = !queryInput.value.trim();
        }

        // â”€â”€ iframe auto-resize â”€â”€
        function postHeight() {
            window.parent.postMessage({ type: "placebogpt-resize", height: document.documentElement.scrollHeight }, "*");
        }
        window.addEventListener("load", postHeight);
        new ResizeObserver(postHeight).observe(document.body);
    </script>
</body>
</html>
